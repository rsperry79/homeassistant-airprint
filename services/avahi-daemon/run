#!/usr/bin/with-contenv bashio
# shellcheck source="../../src/common/paths/avahi-paths.sh"
source "/opt/common/paths/avahi-paths.sh"

ulimit -n 524288

debug_flag="false"
if bashio::config.has_value 'AVAHI_SETTINGS.AVAHI_DEBUG'; then
    debug_flag=$(bashio::config 'AVAHI_SETTINGS.AVAHI_DEBUG')
else
    debug_flag="false"
fi

bashio::log.info "Starting Avahi daemon from S6"
if [ "$debug_flag" == "true" ]; then
    avahi-daemon --debug --file="$avahi_config_path"/"$avahi_daemon"
else
    avahi-daemon --file="$avahi_config_path"/"$avahi_daemon"
fi
